<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
        <link rel="stylesheet" href="../../css/prism.css">
        <script src="../../js/prism.js"></script>
        <script src="js/copycode.js"></script>
        <script type="module"
            src="https://unpkg.com/@deckdeckgo/highlight-code@latest/dist/deckdeckgo-highlight-code/deckdeckgo-highlight-code.esm.js"></script>
    </head>
    <body>
        <pre>
            An attacker in the network is trying to poison the arp table of 11.0.0.100, 
            the admin captured this PCAP.
            Link
            <a href="https://hubchallenges.s3-eu-west-1.amazonaws.com/Forensics/ARP+Storm.pcap">https://hubchallenges.s3-eu-west-1.amazonaws.com/Forensics/ARP+Storm.pcap</a>

            <blockquote class="mk">
                This is a network challenge which we are required to get the flag through analysis
                of a .pcap file. To achieve the same….tshark is the tool that we will use.
            </blockquote>

            Copy the link and paste in the browser,,,will download the capture file that
            we are supposed to analyze.

            use the following commands to open the packet capture..

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                    tshark -r ARP+Storm.pcap
                </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            the -r flag is used for reading data from an infile including the gzipped files.

            <img src="../../public/images/Network Security/Arp Storm/Arp Storm-1.png"/>

            Then type the following command to filter the packets.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                    tshark -r ARP+Storm.pcap -Tfields -e arp.opcode | awk ‘{printf(“%c”,$1)}’
                </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            the -T used to set the format of the output when veiwing the decoded packet
            data ….and values in the fields are specified with the -e option which adds
            the list of fields to be displayed…the option can be used multiple times. We
            only want to include the arp.opcode in the output…

            The awk is used to perform pattern scanning and processing. where in this
            case we are looking for any packet with a base64 encoded arp.opcode from the
            filter applied | <b>awk ‘{printf(“%c”,$1)}’</b>

            <img src="../../public/images/Network Security/Arp Storm/Arp Storm-2.png"/>

            Then in the previous command we add a command to decode that content
            that is encoded from the result we found,,,,,,,,,,it will now look like this.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                    tshark -r ARP+Storm.pcap -Tfields -e arp.opcode | awk ‘{printf(“%c”,$1)}’| base64 -d
                </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="../../public/images/Network Security/Arp Storm/Arp Storm-3.png"/>
        </pre>
        <h2><i>
            flag{gr@tuit0us_0pcOde_1s_Alw@ys_A6uSed_t0_p01s0n}
        </i></h2>
    </body>
</html>