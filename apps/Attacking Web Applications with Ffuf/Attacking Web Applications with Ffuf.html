<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
        <link rel="stylesheet" href="../../css/prism.css">
        <script src="../../js/prism.js"></script>
        <script src="js/copycode.js"></script>
        <script type="module"
            src="https://unpkg.com/@deckdeckgo/highlight-code@latest/dist/deckdeckgo-highlight-code/deckdeckgo-highlight-code.esm.js"></script>
    </head>
    <body>

        <pre>
            <b>
                Introduction to Ffuf
            </b>

            Ffuf is a powerful and fast web fuzzer written in Go. It allows security
            researchers and penetration testers to discover hidden files, directories, and
            other web application vulnerabilities by performing recursive and brute-
            force searches. Ffuf is known for its speed and flexibility, making it an
            excellent tool for CTF challenges.

            <b>
                The CTF Challenge
            </b>

            Letâ€™s dive into the CTF challenge that we will be solving using Ffuf. The
            challenge involves finding hidden directories and files on a web application
            hosted at http://83.136.250.34:53339. We will be using Ffuf to perform the
            fuzzing and discover these hidden resources.

            <b>
                Step 1: Discovering Hidden Directories
            </b>

            To begin the challenge, we execute Ffuf with a wordlist containing common
            directory names and the target URL http://83.136.250.34:53339/FUZZ. The
            command looks like this:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        sudo ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://83.136.250.34:53339/FUZZ

                        /'___\  /'___\           /'___\       
                        /\ \__/ /\ \__/  __  __  /\ \__/       
                        \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
                         \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
                          \ \_\   \ \_\  \ \____/  \ \_\       
                           \/_/    \/_/   \/___/    \/_/       
                      

                        v1.4.1-dev
                    ________________________________________________

                    :: Method           : GET
                    :: URL              : http://83.136.250.34:53339/FUZZ
                    :: Wordlist         : FUZZ: /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt
                    :: Follow redirects : false
                    :: Calibration      : false
                    :: Timeout          : 10
                    :: Threads          : 40
                    :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
                    ________________________________________________

                    # Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    blog                    [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 0ms]
                    # directory-list-2.3-small.txt [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    #                       [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # Copyright 2007 James Fisher [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # This work is licensed under the Creative Commons  [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # on atleast 3 different hosts [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    #                       [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # Priority ordered case sensative list, where entries were found  [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                                            [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    #                       [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    #                       [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    # Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    forum                   [Status: 301, Size: 323, Words: 20, Lines: 10, Duration: 0ms]
                                            [Status: 200, Size: 986, Words: 423, Lines: 56, Duration: 0ms]
                    :: Progress: [87664/87664] :: Job [1/1] :: 9901 req/sec :: Duration: [0:02:06] :: Errors: 0 
                    ::After running the command, Ffuf starts scanning the target URL with the provided wordlist. 
                    It sends multiple requests and analyzes the responses to identify existing directories. 
                    The output reveals the discovered directories along with their corresponding 
                    HTTP response status codes, sizes, words, lines, and durations.
                </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            Ffuf executes the fuzzing operation, sending multiple requests to the target
            URL with different filenames. It analyzes the responses and provides output
            with details similar to the previous step.

            After the fuzzing process, Ffuf discovers the following page:

            /blog/home.php (Status: 200, Size: 1046, Words: 438, Lines: 58)

            To find the flag, we navigate to the discovered page:
            http://83.136.250.34:53339/blog/home.php. The flag is revealed on this page:

            Flag: HTB{bru73_f0r_c0mm0n_*********}

            <b>
                Step 3: Finding More Files/Directories
            </b>

            In the third step, we continue the search for additional files and directories.
            One of these resources should provide us with another flag. We need to
            apply the knowledge gained so far and repeat the process.

            After exploring further, we find the following URL containing the second flag:

            http://94.237.62.6:51052/forum/flag.php

            Flag: HTB{fuzz1n6_7h3_****}

            <b>
                Step 4: Discovering the Swag Shop Sub-Domain
            </b>

            In the final step, we perform a sub-domain fuzzing test on hackthebox.eu to
            discover the online Swag Shop of HackTheBox. We use Ffuf with a wordlist of
            subdomains and the target URL http://FUZZ.hackthebox.eu/. The command
            is as follows:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.hackthebox.eu/

                        /'___\  /'___\           /'___\       
                       /\ \__/ /\ \__/  __  __  /\ \__/       
                       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
                        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
                         \ \_\   \ \_\  \ \____/  \ \_\       
                          \/_/    \/_/   \/___/    \/_/       
                
                       v1.4.1-dev
                ________________________________________________
                
                 :: Method           : GET
                 :: URL              : http://FUZZ.hackthebox.eu/
                 :: Wordlist         : FUZZ: /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
                 :: Follow redirects : false
                 :: Calibration      : false
                 :: Timeout          : 10
                 :: Threads          : 40
                 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
                ________________________________________________
                
                dev                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 22ms]
                mail                    [Status: 301, Size: 236, Words: 9, Lines: 7, Duration: 14ms]
                forum                   [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 33ms]
                www                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 57ms]
                :: Progress: [112/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 69 ::: Progress: [169/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 125 app                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 35ms]
                :: Progress: [171/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 127 forums                  [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 42ms]
                :: Progress: [177/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 132 store                   [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 57ms]
                :: Progress: [179/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 133 help                    [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 28ms]
                :: Progress: [186/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 139 dev2                    [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 18ms]
                :: Progress: [211/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 163 api                     [Status: 301, Size: 162, Words: 5, Lines: 8, Duration: 76ms]
                :: Progress: [270/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 221 :: Progress: [313/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 263 calendar                [Status: 302, Size: 249, Words: 9, Lines: 7, Duration: 9ms]
                :: Progress: [389/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 339 billing                 [Status: 301, Size: 162, Words: 5, Lines: 8, Duration: 11ms]
                :: Progress: [434/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 383 :: Progress: [443/4997] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 391 MAIL                    [Status: 301, Size: 236, Words: 9, Lines: 7, Duration: 11ms] 

            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        store.hackthebox.eu (Status: 200, Size: ..., Words: ..., Lines: ...)

        The full domain of the HackTheBox Swag Shop is store.hackthebox.eu.

        <b>
            Step 5: VHost Fuzzing
        </b>

        The first challenge requires us to perform a VHost fuzzing scan on the
        domain â€˜academy.htbâ€™ and identify any additional VHosts. To accomplish
        this, we use the ffuf tool with the following command:

        <div class="container">
            <deckgo-highlight-code id="codeToCopy">
                <code slot="code">
                    ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://94.237.59.206:42671/ -H 'Host: FUZZ.academy.htb' -ms 0


                    /'___\  /'___\           /'___\       
                    /\ \__/ /\ \__/  __  __  /\ \__/       
                    \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
                     \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
                      \ \_\   \ \_\  \ \____/  \ \_\       
                       \/_/    \/_/   \/___/    \/_/       

                        v2.0.0-dev
                    ________________________________________________

                    :: Method           : GET
                    :: URL              : http://94.237.59.206:42671/
                    :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
                    :: Header           : Host: FUZZ.academy.htb
                    :: Follow redirects : false
                    :: Calibration      : false
                    :: Timeout          : 10
                    :: Threads          : 40
                    :: Matcher          : Response size: 0
                    ________________________________________________

                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 59ms]
                        * FUZZ: test

                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 4155ms]
                        * FUZZ: admin

                    :: Progress: [4989/4989] :: Job [1/1] :: 578 req/sec :: Duration: [0:00:11] :: Errors: 0 ::

                </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            The scan result reveals the existence of two VHosts: â€˜test.academy.htbâ€™ and
            â€˜admin.academy.htbâ€™.

            <b>
                Step 6: Parameter Fuzzing
            </b>

            In the second challenge, we need to run a parameter fuzzing scan on a
            specific webpage and determine the accepted parameter. Using the ffuf
            tool, we execute the following command:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://admin.academy.htb:34138/admin/admin.php?FUZZ=key -fs 798
                        user
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>    

            The scan output indicates that the parameter â€˜keyâ€™ is accepted by the webpage.

            <b>
                Step 7: Wordlist Creation and POST Request
            </b>

            For the third challenge, we have to create a wordlist called â€˜ids.txt,â€™ identify
            the accepted value through a fuzzing scan, and use it in a â€˜POSTâ€™ request with
            â€˜curlâ€™ to retrieve the flag. Letâ€™s follow these steps:

            Create the wordlist â€˜ids.txtâ€™ with the desired values.
            Perform a fuzzing scan using ffuf to identify the accepted value for the 'id' parameter:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:34138/admin/admin.php -X POST -d 'id=73' -H 'Content-Type: application/x-www-form-urlencoded'
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            The response contains the flag: HTB{p4r4m373r_fuzz1n6_15_****}.

            Skills Assessment â€” Web Fuzzing

            <b>
                Step 1: Sub-Domain/VHost and Extension Fuzzing
            </b>

            In the fourth challenge, we are tasked with running a sub-domain/VHost
            fuzzing scan on â€˜.academy.htbâ€™ and identifying all the sub-domains. We
            employ ffuf once again:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://94.237.55.114:47287/ -H 'Host: FUZZ.academy.htb' -ms 0

                        /'___\  /'___\           /'___\       
                       /\ \__/ /\ \__/  __  __  /\ \__/       
                       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
                        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
                         \ \_\   \ \_\  \ \____/  \ \_\       
                          \/_/    \/_/   \/___/    \/_/       
                
                       v2.0.0-dev
                ________________________________________________
                
                 :: Method           : GET
                 :: URL              : http://94.237.55.114:47287/
                 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
                 :: Header           : Host: FUZZ.academy.htb
                 :: Follow redirects : false
                 :: Calibration      : false
                 :: Timeout          : 10
                 :: Threads          : 40
                 :: Matcher          : Response size: 0
                ________________________________________________
                
                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 63ms]
                    * FUZZ: test
                
                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 61ms]
                    * FUZZ: archive
                
                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 67ms]
                    * FUZZ: faculty
                
                :: Progress: [4989/4989] :: Job [1/1] :: 578 req/sec :: Duration: [0:00:09] :: Errors: 0 ::     
                 </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            The scan output reveals three sub-domains: â€˜test.academy.htb,â€™
            â€˜archive.academy.htb,â€™ and â€˜faculty.academy.htb.â€™

            Before running the page fuzzing scan, itâ€™s recommended to perform an
            extension fuzzing scan. The goal is to identify the different extensions
            accepted by the domains. We can accomplish this with the following command:

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://94.237.55.114:47287/indexFUZZ


                        /'___\  /'___\           /'___\       
                       /\ \__/ /\ \__/  __  __  /\ \__/       
                       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
                        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
                         \ \_\   \ \_\  \ \____/  \ \_\       
                          \/_/    \/_/   \/___/    \/_/       
                
                       v2.0.0-dev
                ________________________________________________
                
                 :: Method           : GET
                 :: URL              : http://94.237.55.114:47287/indexFUZZ
                 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/web-extensions.txt
                 :: Follow redirects : false
                 :: Calibration      : false
                 :: Timeout          : 10
                 :: Threads          : 40
                 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
                ________________________________________________
                
                [Status: 200, Size: 985, Words: 423, Lines: 55, Duration: 63ms]
                    * FUZZ: .php
                
                [Status: 403, Size: 281, Words: 20, Lines: 10, Duration: 61ms]
                    * FUZZ: .phps
                
                :: Progress: [40/40] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::The scan output indicates that the extensions â€˜.phpâ€™ and â€˜.phpsâ€™ are accepted.
                
            </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        <div class="container">
            <deckgo-highlight-code id="codeToCopy">
                <code slot="code">
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://faculty:47287/indexFUZZ
                    .php7
                </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        One of the pages you will identify should say â€˜You donâ€™t have access!â€™. What is
        the full page URL?

        <div class="container">
            <deckgo-highlight-code id="codeToCopy">
                <code slot="code">
                    ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u <http://faculty.academy.htb:47287/FUZZ> -recursion -recursion-depth 1 -e .php -v -t 80
                    index.hph7
                    courses
                    linux-security.php7
                </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        http://faculty.academy.htb:47287/courses/linux-security.php7

        <b>
            Challenge 5: Parameter Identification and Fuzzing
        </b>

        In the fifth challenge, we need to identify the parameters accepted by a
        specific page obtained in the previous step. We run the following command 
        to achieve this:

        <div class="container">
            <deckgo-highlight-code id="codeToCopy">
                <code slot="code">
                    ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:PORT/courses/linux-security.php7 -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded'
                    ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:30796/courses/linux-security.php7 -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs 774
                </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        The scan output reveals two parameters: â€˜userâ€™ and â€˜username.â€™

        Next, we are required to fuzz the identified parameters with working values
        to retrieve the flag. We can accomplish this using the following command:

        <div class="container">
            <deckgo-highlight-code id="codeToCopy">
                <code slot="code">
                    ffuf -w /opt/useful/SecLists/Usernames/xato-net-10-million-usernames.txt:FUZZ -u http://faculty.academy.htb:30401/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'
                    ffuf -w /opt/useful/SecLists/Usernames/xato-net-10-million-usernames.txt:FUZZ -u http://faculty.academy.htb:30401/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 781
                </code></deckgo-highlight-code>
            <button id="copyButton">Copy</button>
        </div>

        The response contains the flag: HTB{w3b_fuzz1n6_******}.

        </pre>
    </body>