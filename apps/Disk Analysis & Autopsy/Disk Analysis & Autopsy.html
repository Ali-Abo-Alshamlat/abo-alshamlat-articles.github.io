<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
    </head>
    <body>

        <pre>
            Room Link: <a href="https://tryhackme.com/room/autopsy2ze0">https://tryhackme.com/room/autopsy2ze0</a>

            <h1>
                Task 1 Windows 10 Disk Image
            </h1>

            In the attached VM, there is an Autopsy case file and its corresponding disk
            image. After loading the .aut file, make sure to re-point Autopsy to the disk
            image file.

            Start Autopsy and select “Open Case”

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-1.png"/>

            Select the “.aut” file.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-2.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-3.png"/>

            Select the image “HASAN2.E01”

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-4.png"/>

            Ingest Modules were already ran for your convenience.

            Your task is to perform a manual analysis of the artifacts discovered by
            Autopsy to answer the questions below.

            This room should help to reinforce what you learned in the Autopsy room.
            Have fun investigating!


            RDP Machine Details:

            IP: MACHINE_IP
            Username: administrator
            Password: letmein123!

            <b>
                Answer the questions below
            </b>

            <b>
                What is the MD5 hash of the E01 image?
            </b>

            <h3>
                Answer: 3f08c518adb3b5c1359849657a9b2079
            </h3>

            Click the “Data Source” tree, and on the right panel, there is metadata of the file.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-5.png"/>

            <b>
                What is the computer account name?
            </b>

            <h3>
                Answer: DESKTOP-0R59DJ3
            </h3>

            Expand the “Expanded Content” under the “Results” tree. Click “Operating
            System Information” and the right panel will display the name of the computer.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-6.png"/>

            <b>
                List all the user accounts. (alphabetical order)
            </b>

            <h3>
                Answer: H4S4N,joshwa,keshav,sandhya,shreya, sivapriya,srini,suba
            </h3>

            The specific relevant content for this request, if necessary, delimited with
            characters: Select “Operating System User Account” and sort by “User ID”.
            Regular users are those starting with UID of 1000.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-7.png"/>

            <b>
                Who was the last user to log into the computer?
            </b>

            <h3>
                Answer: sivapriya
            </h3>

            This time around, sort it by “Date Accessed”.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-8.png"/>

            <b>
                What was the IP address of the computer?
            </b>

            <h3>
                Answer: 192.168.130.216
            </h3>

            Head on to the location of “Program Files”, and in it is a tool for network
            monitoring. Expand the folder and within the folder is a file that contains
            the network information of the system. The variable “LANIP” contains the IP
            value of the system.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-9.png"/>

            <b>
                What was the MAC address of the computer? (XX-XX-XX-XX-XX-XX)
            </b>

            <h3>
                Answer: 08–00–27–2c-c4-b9
            </h3>

            From the same location, the MAC address is found in the variable “LANNIC”.
            Edit the value in MAC address format.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-10.png"/>

            <b>
                What is the name of the network card on this computer?
            </b>

            <h3>
                Answer: Intel(R) PRO/1000 MT Desktop Adapter
            </h3>

            For network connections, we can search the registry hive
            “SOFTWARE\Microsoft\Windows NT\CurrentVersion” where the “ROOT”
            location is “C:\Windows\system32\config”.

            We can also double-click on “SOFTWARE” and it will take us to the “ROOT” location.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-11.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-12.png"/>

            Within “CurrentVersion” is a key called “NetworkCards” and within it is a
            subkey called “2”. And we can see the name of the adapter in the
            “Description” key value.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-13.png"/>

            <b>
                What is the name of the network monitoring tool?
            </b>

            <h3>
                Answer: Look@LAN
            </h3>

            As observed from above, a tool was used to monitor network traffic. Another
            way to search for it is to look under the “Installed Program” and be critical of
            software that are suspicious.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-14.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-15.png"/>

            <b>
                A user bookmarked a Google Maps location. What are the
                coordinates of the location?
            </b>

            <h3>
                Answer: 12°52'23.0"N 80°13'25.0"E
            </h3>

            In the “Extracted Content” is a web bookmark that contains information of
            bookmarked URLs.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-16.png"/>

            <b>
                A user has his full name printed on his desktop wallpaper. What
                is the user’s full name?
            </b>

            <h3>
                Answer: Anto Joshwa
            </h3>

            Click on the “Images/Videos” tab to display images or videos that were
            extracted. Go through all the users’ directories. User “joshua” has an image
            in the “Downloads” folder. Expand the window, and it can be seen that the
            user’s full name was printed on the image.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-17.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-18.png"/>

            <b>
                A user had a file on her desktop. It had a flag but she changed
                the flag using PowerShell. What was the first flag?
            </b>

            <h3>
                Answer: flag{HarleyQuinnForQueen}
            </h3>

            Check the PowerShell history for each user. Here, we see in user Shreya’s
            PowerShell history that the initial flag of ‘I hacked you’ of the text file was
            changed to ‘flag{HarleyQuinnForQueen}’.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-19.png"/>

            <b>
                The same user found an exploit to escalate privileges on the
                computer. What was the message to the device owner?
            </b>

            <h3>
                Answer: Flag{I-hacked-you}
            </h3>

            Going to Shreya’s desktop folder, we see a PowerShell script that will elevate
            privileges on the computer. We can also see a text file that will be created
            once the script is executed, which will add the content ‘I hacked you’.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-20.png"/>

            <b>
                2 hack tools focused on passwords were found in the system.
                What are the names of these tools? (alphabetical order)
            </b>

            <h3>
                Answer: lazagne,mimikatz
            </h3>

            The first tool can be located in a user’s download folder, where a very
            popular tool used for dumping credentials was probably downloaded.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-21.png"/>

            We can also look at the “prefetch” file to find information about programs
            that were executed. Here is an unfamiliar tool, but with Googling, I found
            out that it is also used for retrieving passwords.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-22.png"/>

            The said program can also be found in the “Run Programs” under the “Results” tree.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-23.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-24.png"/>

            <b>
                There is a YARA file on the computer. Inspect the file. What is
                the name of the author?
            </b>

            <h3>
                Benjamin DELPY (gentilkiwi)
            </h3>

            We can search for files that have a “.yar” extension.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-25.png"/>

            If we click on the file found, we see more info about the file like its location.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-26.png"/>

            The file cannot be located on the “Desktop” folder, but as identified earlier,
            there was a “mimikatz” file in the “Downloads” folder of the same user.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-27.png"/>

            Click on the file and the metadata will show the author of mimikatz.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-28.png"/>

            <b>
                One of the users wanted to exploit a domain controller with an
                MS-NRPC based exploit. What is the filename of the archive that
                you found? (include the spaces in your answer)
            </b>

            <h3>
                Answer: 2.2.0 20200918 Zerologon encrypted.zip
            </h3>

            Going over the “Recent Documents”, there was an exploit downloaded that
            will take advantage of “Zerologon”.

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-29.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-30.png"/>

            <img src="/public/images/Disk Analysis & Autopsy/Disk Analysis & Autopsy-31.png"/>
        </pre>
    </body>