<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../css/Font.css">
        <link rel="stylesheet" href="css/code.css">
        <script src="js/folderview.js"></script>
    </head>
    <body>
        <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-1.png"/>

        <pre>
            In this challenge, we got an image file for a Windows system. I used FTK
            Imager for looking around for anything looking weird, and I have checked
            the most common places when it comes to forensics, like downloads,
            documents, desktops, and temp directories.

            The only thing I have found is this, which is a bit sus.

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-2.png"/>

            So, I get the hash of the executable, and looking at the virus total, it shows
            that it is malicious.

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-3.png"/>

            Now we have the first part of the flag
            <h3>Flag{316fcaf0160b0025e13187624d0ac081_?_?}</h3>

            The challenge name is History, so it kind of makes sense to check the history
            of the browser. Also, the challenge says the ads got him.

            Checking history at this path

            <i>
                AppData/Local/Micorosoft/Edge/UserData/Default/History
            </i>
            Open it with any SQL lite viewer.

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-4.png"/>

            Now you got the second part
            <h3>Flag{316fcaf0160b0025e13187624d0ac081_156.26.173.114_?}</h3>

            For the last part of the flag, it requires a bit of reverse, but before that, let me
            explain the mindset. We need to get the wallet address that it may be a
            bitcoin address or smth, so normally attackers leave that as a note on
            Desktop folder, but in our case, there are no files there. After checking the
            strings on the malicious executable and doing some basic static analysis, I
            had no luck.

            Thatâ€™s when i decided to fire IDA, which is debugger that reverse engineers
            use for extracting IOCs and doing their reverse nerdy stuff

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-5.png"/>

            When I fired, I noticed this string 'secr3t', which is value that the malware
            stored inside this registry key 
            <i>SOFTWARE\Microsoft\Windows NT\CurrentVersion.</i>

            I have exported the SOFTWARE Hive and checked this secr3t value, and we
            got something.

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-6.png"/>

            Hella weird, right? I grabbed this nonsense and told Cyberchef I wanted to
            do something that made sense from that.

            <img src="/public/images/BlueTeam Scholarship CTF Writeups/History 102/History 102-7.png"/>

            CyberChef never disappoints me.

            Now we got the three parts of the flag
        </pre>
        <h2><i>
            Flag{316fcaf0160b0025e13187624d0ac081_156.26.173.114_bc1qxy2kgdygjrsqtzq2n0yrf2493!83kkfjhx0wlh}
        </i></h2>
    </body>
</html>